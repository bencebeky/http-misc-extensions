<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The "SNI" Alt-Svc Parameter</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract p {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre {
  font: 15px Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Usage">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 The &#8220;sni&#8221; Alt-Svc Extension">
<link href="#rfc.section.3" rel="Chapter" title="3 Examples">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 SNI of Colocated Domain">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Wildcard Subdomains">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Omitting SNI">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 SNI of Unrelated Domain">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.10.3 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Bishop, M." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-bishop-httpbis-sni-altsvc-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-05" />
  <meta name="dct.abstract" content="HTTP Alternative Services provides a mechanism for an origin to declare that its content is accessible via some other combination of host, port, and protocol.  In the process of using such an alternative, an observer can identify that the client is requesting resources from a particular hostname." />
  <meta name="description" content="HTTP Alternative Services provides a mechanism for an origin to declare that its content is accessible via some other combination of host, port, and protocol.  In the process of using such an alternative, an observer can identify that the client is requesting resources from a particular hostname." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">HTTPbis</td>
<td class="right">M. Bishop</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Akamai</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">October 5, 2018</td>
</tr>
<tr>
<td class="left">Expires: April 8, 2019</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The "SNI" Alt-Svc Parameter<br />
  <span class="filename">draft-bishop-httpbis-sni-altsvc-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>HTTP Alternative Services provides a mechanism for an origin to declare that its content is accessible via some other combination of host, port, and protocol.  In the process of using such an alternative, an observer can identify that the client is requesting resources from a particular hostname.</p>
<p>This document extends HTTP Alternative Services, in combination with Secondary Certificate Authentication, to enable clients not to disclose the origin to which they intend to connect.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 8, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Usage</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Notational Conventions</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">The &#8220;sni&#8221; Alt-Svc Extension</a>
</li>
<li>3.   <a href="#rfc.section.3">Examples</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">SNI of Colocated Domain</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Wildcard Subdomains</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Omitting SNI</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">SNI of Unrelated Domain</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#problems" id="problems">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Confidentiality and authentication during communication are primary goals of using TLS to secure traffic on the Internet.  However, due to the nature of TLS, certain information is inherently not confidential &#8211; notably, the hostname and the corresponding certificate of the origin to which the client is connecting are transferred unencrypted in the Server Name Indication extension <a href="#SNI" class="xref">[SNI]</a> and the server&#8217;s Certificate message <a href="#TLS12" class="xref">[TLS12]</a>.</p>
<p id="rfc.section.1.p.2">While the client identity can be obscured by using TLS renegotiation immediately after the handshake (in TLS 1.2) or by using TLS 1.3 <a href="#TLS13" class="xref">[TLS13]</a>, the server is not afforded such privacy considerations.</p>
<p id="rfc.section.1.p.3">Servers may also have wildcard certificates which do not enumerate specific subdomains, but clients will disclose the first subdomain used on a connection via the SNI extension when establishing the connection.</p>
<p><a href="#SNIEncryption" class="xref">[SNIEncryption]</a> discusses a potential solution to these issues in Section 3, HTTP Co-Tenancy Fronting, but notes both discoverability and server authentication issues with that approach. This document provides a mechanism to address both limitations.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#usage" id="usage">Usage</a>
</h1>
<p id="rfc.section.1.1.p.1">In <a href="#AltSvc" class="xref">[AltSvc]</a>, once a client has received a validated Alternative Service record for an origin, it &#8220;SHOULD use that alternative service for all requests to the associated origin as soon as it is available, provided the alternative service information is fresh (Section 2.2) and the security properties of the alternative service protocol are desirable, as compared to the existing connection.&#8221; However, the client &#8220;MUST have reasonable assurances that the alternative service is under control of and valid for the whole origin &#8230; established through use of a TLS-based protocol with the certificate checks defined in <a href="#RFC2818" class="xref">[RFC2818]</a>.&#8221;  This causes the origin to be disclosed in the SNI extension while connecting to the alternative, and the origin&#8217;s certificate to be returned by the alternative, creating the same privacy issues as connecting directly to the origin.</p>
<p id="rfc.section.1.1.p.2">The extension described in <a href="#extension" class="xref">Section 2</a> enables an origin to declare that reasonable assurances should be obtained, not by requesting the desired hostname in the TLS handshake, but by requesting it via <a href="#SecondaryCerts" class="xref">[SecondaryCerts]</a>.  The validation checks from <a href="#RFC2818" class="xref">[RFC2818]</a> are applied to this certificate.</p>
<p id="rfc.section.1.1.p.3">Because the entire exchange happens inside TLS, a passive observer cannot identify the hostname(s) the client might be requesting.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#notational-conventions" id="notational-conventions">Notational Conventions</a>
</h1>
<p id="rfc.section.1.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.1.2.p.2">The key words &#8220;MUST (BUT WE KNOW YOU WON&#8217;T)&#8221;, &#8220;SHOULD CONSIDER&#8221;, &#8220;REALLY SHOULD NOT&#8221;, &#8220;OUGHT TO&#8221;, &#8220;WOULD PROBABLY&#8221;, &#8220;MAY WISH TO&#8221;, &#8220;COULD&#8221;, &#8220;POSSIBLE&#8221;, and &#8220;MIGHT&#8221; in this document are to be interpreted as described in <a href="#RFC6919" class="xref">[RFC6919]</a>.</p>
<p id="rfc.section.1.2.p.3">Field definitions are given in Augmented Backus-Naur Form (ABNF), as defined in <a href="#RFC5234" class="xref">[RFC5234]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#extension" id="extension">The &#8220;sni&#8221; Alt-Svc Extension</a>
</h1>
<p id="rfc.section.2.p.1">When an origin wishes to nominate a &#8220;fronting server&#8221;, it includes the <samp>sni</samp> parameter in its alternative service entry.</p>
<p id="rfc.section.2.p.2">Syntax:</p>
<pre>
sni = ( reg-name / empty-string )
empty-string = DQUOTE DQUOTE
</pre>
<p><samp>reg-name</samp> is defined in Section 3.2.2 of <a href="#RFC3986" class="xref">[RFC3986]</a>.</p>
<p id="rfc.section.2.p.4">When processing such an alternative, clients SHOULD present the hostname given in the <samp>sni</samp> parameter in the SNI extension during the TLS handshake. If the hostname given is an empty string, clients SHOULD omit the SNI extension from the TLS handshake.  The server MUST return a valid certificate which covers at least one of the following:</p>
<p></p>

<ul>
<li>The hostname indicated in the SNI extension</li>
<li>The hostname of the origin that published the alternative</li>
<li>The hostname used for connecting to the alternative</li>
</ul>
<p id="rfc.section.2.p.6">The client MUST validate the certificate in the handshake for authenticity according to <a href="#RFC2818" class="xref">[RFC2818]</a> and ensure that it is valid for at least one of these names.  Clients SHOULD NOT accept certificates issued to the IP address of the alternative unless the alternative is specified as an IP literal.</p>
<p id="rfc.section.2.p.7">If the certificate is not valid for the origin&#8217;s hostname, the client MUST NOT make requests to any origin corresponding to this certificate. In this case, the client SHOULD send a <samp>CERTIFICATE_REQUEST</samp> frame including an SNI extension indicating the origin which published the alternative service immediately upon connecting.  If no corresponding <samp>CERTIFICATE</samp> frame is presented by the server after a reasonable timeout, or if the server&#8217;s SETTINGS frame does not include the <samp>SETTINGS_HTTP_CERT_AUTH</samp> setting, the client MUST consider the alternative connection to have failed.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#sni-of-colocated-domain" id="sni-of-colocated-domain">SNI of Colocated Domain</a>
</h1>
<p id="rfc.section.3.1.p.1">Suppose a client has received the following Alt-Svc entry for sensitive.example.com in the past:</p>
<pre>
h2="innocence.org:443";ma=2635200;persist=true;sni=innocence.org
</pre>
<p id="rfc.section.3.1.p.2">If the client now wishes to make a request to https://sensitive.example.com/private, it would perform a DNS resolution for innocence.org. The client would then open a TCP connection to the resulting IP address and begin a TLS handshake.</p>
<p id="rfc.section.3.1.p.3">In the client&#8217;s TLS handshake, it would request a certificate for the hostname &#8220;innocence.org&#8221;.  The TLS server would present such a certificate, issued by an authority trusted by the client. The client will validate the certificate for the name &#8220;sensitive.example.com&#8221;.  When validation fails, the client will try to validate the certificate for the name &#8220;innocence.org&#8221;, which will succeed.  After validation succeeds, the client will send a <samp>CERTIFICATE_REQUEST</samp> frame asking that the server also authenticate with a certificate for sensitive.example.com.</p>
<p id="rfc.section.3.1.p.4">After receiving the <samp>CERTIFICATE</samp> frame proving possession of a certificate for sensitive.example.com, the client will verify that this certificate is trusted.  If so, the client will proceed to send HTTP/2 requests to the server requesting the resource https://sensitive.example.com/private.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#wildcard-subdomains" id="wildcard-subdomains">Wildcard Subdomains</a>
</h1>
<p id="rfc.section.3.2.p.1">Suppose a client has received the following Alt-Svc entry for sensitive.example.com in the past:</p>
<pre>
h2="www.example.com:443";ma=2635200;persist=true;sni=www.example.com
</pre>
<p id="rfc.section.3.2.p.2">If the client now wishes to make a request to https://sensitive.example.com/private, it would perform a DNS resolution for www.example.com, the specified alternative. The client would then open a TCP connection to the resulting IP address and begin a TLS handshake.</p>
<p id="rfc.section.3.2.p.3">In the client&#8217;s TLS handshake, it would request a certificate for the hostname www.example.com.  The TLS server would present a certificate which included www.example.com as one of the covered hostnames.</p>
<p id="rfc.section.3.2.p.4">Suppose that the certificate with which the server authenticated also contained a Subject Alternative Name of &#8220;*.example.com&#8221;.  Because the certificate covers the desired origin, the client would perform validity checks on this certificate.</p>
<p id="rfc.section.3.2.p.5">If the certificate is trusted, the client will proceed to send HTTP/2 requests to the server requesting the resource https://sensitive.example.com/private.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#omitting-sni" id="omitting-sni">Omitting SNI</a>
</h1>
<p id="rfc.section.3.3.p.1">Suppose a client has received the following Alt-Svc entry for sensitive.example.com in the past:</p>
<pre>
h2="alternative.example.com:443";ma=2635200;persist=true;sni=""
</pre>
<p id="rfc.section.3.3.p.2">If the client now wishes to make a request to https://sensitive.example.com/private, it would perform a DNS resolution for alternative.example.com, the specified alternative. The client would then open a TCP connection to the resulting IP address and begin a TLS handshake.</p>
<p id="rfc.section.3.3.p.3">In the client&#8217;s TLS handshake, it would omit the Server Name Indication extension.  The TLS server would present a certificate according to its configured defaults.</p>
<p id="rfc.section.3.3.p.4">The server would supply a certificate that covers sensitive.example.com, for example because it contains a Subject Alternative Name of &#8220;*.example.com&#8221;, and the client would perform validity checks on this certificate.</p>
<p id="rfc.section.3.3.p.5">If the supplied certificate does not cover sensitive.example.com or alternative.example.com, the client will terminate the connection.  Otherwise, the client will perform validity checks, terminating the connection if the certificate is not valid and trusted.  If the certificate covers sensitive.example.com, the client will send its request over HTTP/2; otherwise, it will send a <samp>CERTIFICATE</samp> frame for &#8220;sensitive.example.com&#8221;.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#sni-of-unrelated-domain" id="sni-of-unrelated-domain">SNI of Unrelated Domain</a>
</h1>
<p id="rfc.section.3.4.p.1">Suppose a client has received the following Alt-Svc entry for sensitive.example.com in the past:</p>
<pre>
h2=":443";ma=2635200;persist=true;sni=other.example
</pre>
<p id="rfc.section.3.4.p.2">If the client now wishes to make a request to https://sensitive.example.com/private, it would perform a DNS resolution for sensitive.example.com (the Alt-Svc entry does not specify a different hostname).  The client would then open a TCP connection to the resulting IP address and begin a TLS handshake.</p>
<p id="rfc.section.3.4.p.3">In the client&#8217;s TLS handshake, it would request a certificate for the hostname &#8220;other.example&#8221;.  The TLS server does not a have a certificate for this hostname, but it would return a certificate for sensitive.example.com, issued by an authority trusted by the client, and the client will successfully validate the certificate for the name &#8220;sensitive.example.com&#8221;.</p>
<p id="rfc.section.3.4.p.4">Note that an active attacker could identify this server by sending a Client Hello with the same SNI value and observing the certificate the server uses to authenticate. The server could mitigate this by authenticating with a valid certificate for other.example.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p><a href="#AltSvc" class="xref">[AltSvc]</a> permits clients to ignore unrecognized parameters.  As a result, servers publishing records with the <samp>sni</samp> parameter cannot be assured that clients will not include their origin in the SNI header when connecting to the nominated alternative.  If, for security reasons, an origin wishes its identity never to be disclosed when the alternative is being used, an alternative mechanism would be required to ascertain client support before generating the Alt-Svc record.</p>
<p id="rfc.section.4.p.2">Clients will need to connect directly to the origin at least once in order to receive the Alt-Svc entry via an HTTP header or <samp>ALTSVC</samp> frame, thus disclosing their use of the origin to the network on the first connection. This could be mitigated by future work defining a way to publish alternative services in a mechanism which can be retrieved confidentially, such as via DNS in combination with <a href="#RFC7858" class="xref">[RFC7858]</a> or <a href="#DoH" class="xref">[DoH]</a>.</p>
<p id="rfc.section.4.p.3">However, servers which publish Alt-Svc records over unencrypted channels (HTTP connections without TLS) or channels without client authorization (DNS, or publicly accessible HTTP resources) enable active observers to build a map of fronting servers by collecting Alt-Svc advertisements.  Servers SHOULD CONSIDER this trade-off in deciding when and how to make Alt-Svc records available to unauthenticated parties.</p>
<p id="rfc.section.4.p.4">While concealing information from passive observers is beneficial, low-effort active attacks still exist.  If an attacker can collect the actual server identity by sending a Client Hello with the same SNI value, the usefulness of this technique is limited.  Server deployments SHOULD reserve sensitive domains for use with Secondary Certificates or conceal them inside wildcards in order to mitigate this.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">The &#8220;Hypertext Transfer Protocol (HTTP) Alt-Svc Parameter Registry&#8221; defines the name space for parameters, as described in <a href="#AltSvc" class="xref">[AltSvc]</a>.  It is maintained at <a href="http://www.iana.org/assignments/http-alt-svc-parameters">http://www.iana.org/assignments/http-alt-svc-parameters</a>.</p>
<p id="rfc.section.5.p.2">This document registers the following parameter:</p>
<p></p>

<dl>
<dt>Name:</dt>
<dd style="margin-left: 8"><samp>sni</samp></dd>
<dt>Specification:</dt>
<dd style="margin-left: 8">This document</dd>
</dl>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="AltSvc">[AltSvc]</b></td>
<td class="top">
<a>Nottingham, M.</a>, <a>McManus, P.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7838">HTTP Alternative Services</a>", RFC 7838, DOI 10.17487/RFC7838, April 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, DOI 10.17487/RFC2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6919">[RFC6919]</b></td>
<td class="top">
<a>Barnes, R.</a>, <a>Kent, S.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc6919">Further Key Words for Use in RFCs to Indicate Requirement Levels</a>", RFC 6919, DOI 10.17487/RFC6919, April 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="SecondaryCerts">[SecondaryCerts]</b></td>
<td class="top">
<a>Bishop, M.</a>, <a>Sullivan, N.</a> and <a>M. Thomson</a>, "<a href="https://tools.ietf.org/html/draft-bishop-httpbis-http2-additional-certs-05">Secondary Certificate Authentication in HTTP/2</a>", Internet-Draft draft-bishop-httpbis-http2-additional-certs-05, October 2017.</td>
</tr>
<tr>
<td class="reference"><b id="SNI">[SNI]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a>, "<a href="https://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>", RFC 6066, DOI 10.17487/RFC6066, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="TLS12">[TLS12]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="TLS13">[TLS13]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-28">The Transport Layer Security (TLS) Protocol Version 1.3</a>", Internet-Draft draft-ietf-tls-tls13-28, March 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="DoH">[DoH]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>P. McManus</a>, "<a href="https://tools.ietf.org/html/draft-ietf-doh-dns-over-https-14">DNS Queries over HTTPS (DoH)</a>", Internet-Draft draft-ietf-doh-dns-over-https-14, August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7858">[RFC7858]</b></td>
<td class="top">
<a>Hu, Z.</a>, <a>Zhu, L.</a>, <a>Heidemann, J.</a>, <a>Mankin, A.</a>, <a>Wessels, D.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7858">Specification for DNS over Transport Layer Security (TLS)</a>", RFC 7858, DOI 10.17487/RFC7858, May 2016.</td>
</tr>
<tr>
<td class="reference"><b id="SNIEncryption">[SNIEncryption]</b></td>
<td class="top">
<a>Huitema, C.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-sni-encryption-03">Issues and Requirements for SNI Encryption in TLS</a>", Internet-Draft draft-ietf-tls-sni-encryption-03, May 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.A.p.1">Conversations with Benjamin Schwartz helped to flesh out this idea.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mike Bishop</span> 
	  <span class="n hidden">
		<span class="family-name">Bishop</span>
	  </span>
	</span>
	<span class="org vcardline">Akamai</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbishop@evequefou.be">mbishop@evequefou.be</a></span>

  </address>
</div>

</body>
</html>
